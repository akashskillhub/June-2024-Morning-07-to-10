import{r as l,o as k,p as L,q as R,s as A,B as y,j as e,l as U}from"./index-53e6f5e0.js";import{u as H,c as B,a as u}from"./index.esm-2a88c53e.js";import{C as D}from"./Container-1b9f5e57.js";import{S as _}from"./Spinner-5009bd66.js";import{C as j}from"./Card-acd79bdf.js";import{F as m}from"./FormControl-64724359.js";import{B as d}from"./Button-b0204afc.js";import"./ThemeProvider-f1165dbe.js";import"./CardHeaderContext-749dcba7.js";import"./index-cf459d82.js";import"./Button-00b2b4ee.js";const X=()=>{const[N,f]=l.useState(!1),[i,h]=l.useState([]),[C,p]=l.useState([]),{data:g}=k(),[F,{isSuccess:P,isLoading:S}]=L(),[v,{isSuccess:b,isLoading:E}]=R(),[q,{isSuccess:I,isLoading:w}]=A(),[r,x]=l.useState(),a=H({enableReinitialize:!0,initialValues:{name:r?r.name:"",desc:r?r.desc:"",price:r?r.price:"",qty:r?r.qty:"",hero:r?r.hero:""},validationSchema:B({name:u().required("Enter name"),desc:u().required("Enter desc"),price:u().required("Enter price"),qty:u().required("Enter qty")}),onSubmit:(s,{resetForm:c})=>{if(r){console.log("update called");const t=new FormData;for(const n in s)n!=="hero"&&t.append(n,s[n]);for(const n of i)t.append("remove",n);for(const n of s.hero)t.append("hero",n);q({_id:r._id,fd:t}),x(null),h([])}else{const t=new FormData;for(const n in s)n!=="hero"&&t.append(n,s[n]);for(const n of s.hero)t.append("hero",n);v(t)}p([]),c()}}),o=s=>U({"form-control my-2":!0,"is-invalid":a.touched[s]&&a.errors[s],"is-valid":a.touched[s]&&!a.errors[s]});return l.useEffect(()=>{b&&y.success("product create success")},[b]),l.useEffect(()=>{P&&y.success("product delete success")},[P]),e.jsxs(D,{children:[E||S||w?e.jsxs(e.Fragment,{children:["Please Wait ... ",e.jsx(_,{})," "]}):e.jsxs(j,{className:"mb-5",children:[e.jsx(j.Header,{children:"Product"}),e.jsx(j.Body,{children:e.jsxs("form",{onSubmit:a.handleSubmit,children:[e.jsx(m,{className:o("name"),placeholder:"Enter Product Name",...a.getFieldProps("name")}),e.jsx(m,{className:o("desc"),placeholder:"Enter Product Description",...a.getFieldProps("desc")}),e.jsx(m,{type:"number",className:o("price"),placeholder:"Enter Product Price",...a.getFieldProps("price")}),e.jsx(m,{type:"number",className:o("qty"),placeholder:"Enter Product Qty",...a.getFieldProps("qty")}),r?e.jsxs(e.Fragment,{children:[r.hero.map(s=>e.jsx("div",{children:e.jsxs("div",{className:`${i.includes(s)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4`,children:[e.jsx("img",{src:s,height:100,className:"me-2 rounded-3",alt:""}),i.includes(s)?e.jsx(d,{onClick:c=>h(i.filter(t=>s!==t)),variant:"dark",children:"cancel"}):e.jsx(d,{variant:"danger",onClick:c=>{i.includes(s)||h([...i,s])},children:"Remove"})]})})),N?e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"file",multiple:!0,onChange:s=>{const c=[];for(const t of s.target.files)c.push(URL.createObjectURL(t));p(c),a.setFieldValue("hero",s.target.files)},className:o("hero"),placeholder:"Enter Product Hero"}),e.jsx(d,{onClick:s=>f(!1),variant:"dark",children:"cancel"})]}):e.jsx(d,{onClick:s=>f(!0),className:"my-3",children:"Add New Image"})]}):e.jsx(e.Fragment,{children:e.jsx(m,{type:"file",multiple:!0,onChange:s=>{const c=[];for(const t of s.target.files)c.push(URL.createObjectURL(t));a.setFieldValue("hero",s.target.files),p(c)},className:o("hero"),placeholder:"Enter Product Hero"})}),C.map(s=>e.jsx("img",{src:s,height:50,alt:""})),r?e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"submit",variant:"warning",className:"w-100 btn-lg",children:"Update Product"}),e.jsx(d,{type:"button",onClick:s=>x(null),variant:"outline-dark",className:"w-100 btn-lg mt-3",children:"Cancel"})]}):e.jsx(d,{type:"submit",className:"w-100 btn-lg",children:"Add Product"})]})})]}),e.jsxs("table",{class:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"qty"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:g&&g.result.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.desc}),e.jsx("td",{children:s.price}),e.jsx("td",{children:s.qty}),e.jsx("td",{children:s.hero.map(c=>e.jsx("img",{src:c,height:50,className:"mx-2 rounded-2",alt:""}))}),e.jsxs("td",{children:[e.jsx(d,{onClick:c=>x(s),className:"me-2",variant:"warning",children:"Edit"}),e.jsx(d,{className:"me-2",variant:"danger",onClick:c=>F(s._id),children:"Remove"})]})]},s._id))})]})]})};export{X as default};
